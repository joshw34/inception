[mysqld]
# ==================== REQUIRED SETTINGS ====================

# Run as mysql user (security)
user = mysql

# Network settings - CRITICAL for Docker
bind-address = 0.0.0.0          # Listen on all interfaces (allows WordPress container to connect)
port = 3306                      # Standard MySQL/MariaDB port
skip-networking = 0              # Enable TCP/IP connections (not just socket)

# Data directory
datadir = /var/lib/mysql

# Socket location
socket = /run/mysqld/mysqld.sock

# ==================== CHARACTER SET (Required for WordPress) ====================

# Use utf8mb4 for full Unicode support (emojis, etc.)
character-set-server = utf8mb4
collation-server = utf8mb4_unicode_ci

# ==================== PERFORMANCE TUNING ====================

# Connection limits
max_connections = 100            # Max simultaneous connections

# Buffer sizes (adjust based on available RAM)
key_buffer_size = 16M           # MyISAM key cache
max_allowed_packet = 64M        # Max size of packet (important for WordPress)
table_open_cache = 64           # Number of open tables
sort_buffer_size = 512K         # Buffer for sorting
net_buffer_length = 8K          # Communication buffer
read_buffer_size = 256K         # Sequential reads
read_rnd_buffer_size = 512K     # Random reads
myisam_sort_buffer_size = 8M    # MyISAM sorting

# ==================== INNODB SETTINGS (WordPress uses InnoDB) ====================

# InnoDB buffer pool (most important for performance)
innodb_buffer_pool_size = 128M  # Cache for InnoDB data/indexes (use 50-70% of RAM in production)

# InnoDB log files
innodb_log_file_size = 48M      # Size of each log file
innodb_log_buffer_size = 8M     # Log buffer

# InnoDB file per table (recommended)
innodb_file_per_table = 1       # Each table in its own file (easier management)

# InnoDB flush behavior
innodb_flush_log_at_trx_commit = 2  # 0=fast but unsafe, 1=safe but slow, 2=balanced

# ==================== LOGGING ====================

# Error log
log_error = /var/log/mysql/error.log

# General query log (disable for performance)
general_log = 0

# Slow query log (useful for debugging)
slow_query_log = 0
slow_query_log_file = /var/log/mysql/slow.log
long_query_time = 2             # Queries taking >2 seconds

# ==================== CLIENT SETTINGS ====================

[client]
port = 3306
socket = /run/mysqld/mysqld.sock
default-character-set = utf8mb4

[mysql]
no-auto-rehash                  # Faster startup
